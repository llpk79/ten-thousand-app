# Copyright 2018 Paul Kutrich. All rights reserved.
#:kivy 1.10.1
#: import ScreenManager kivy.uix.screenmanager.ScreenManager
#: import colors colors.colors
#: import rgba kivy.utils.rgba


ScreenManager:
    id: screen_manager
    MenuScreen:
        id: menu
        name: 'menu'
        manager: 'screen_manager'
    PlayerNumberScreen:
        id: player_number
        name: 'number'
        manager: 'screen_manager'
    PlayerNameScreen:
        id: name
        name: 'name'
        manager: 'screen_manager'
    GameScreen:
        id: game
        name: 'game'
        manager: 'screen_manager'
    ResultsScreen:
        id: results
        name: 'results'
        manager: 'screen_manager'

<MenuScreen>:
    name: 'menu'
    FloatLayout:
        Image:
            source: 'images/tabletop6.jpg'
            allow_stretch: True
            keep_ratio: False
        Label:
            text: 'Let\'s play some dice!'
            color: rgba(colors['text'])
            size_hint: (.2, .1)
            pos_hint: {'x': 0.4, 'y': 0.475}
            on_touch_down: root.parent.current = 'number'
            canvas.before:
                Color:
                    rgba: rgba(colors['prime'])
                Rectangle:
                    pos: self.pos
                    size: self.size

<ResultsScreen>:
    name: 'results'
    FloatLayout:
        Image:
            source: 'images/tabletop1.jpg'
            allow_stretch: True
            keep_ratio: False
        Button:
            text: 'Play again?'
            size_hint: (.15, .05)
            pos_hint: {'x': .45, 'y': .2}
            on_press: root.play_again()
        Button:
            text: 'Exit'
            size_hint: (.15, .05)
            pos_hint: {'x': .45, 'y': .09}
            on_press: root.exit()

<PlayerNameScreen>:
    name: 'name'
    FloatLayout:
        Image:
            source: 'images/tabletop4.jpg'
            allow_stretch: True
            keep_ratio: False

<ButtonLabel>:
    font_size: 50
    halign: 'center'
    color: rgba(colors['text'])
    canvas.before:
        Color:
            rgba: rgba(colors['prime'])
        Rectangle:
            pos: self.x, self.y
            size: self.texture_size[0] + 5, self.texture_size[1]

<PlayerNumberScreen>:
    name: 'number'
    layout: layout
    FloatLayout:
        id: layout
        one: one
        two: two
        three: three
        Image:
            source: 'images/tabletop3.jpg'
            allow_stretch: True
            keep_ratio: False
        Label:
            text: 'How many people are playing?\nUp to three can play.'
            halign: 'center'
            font_size: 40
            color: rgba(colors['text'])
            size_hint: (.275, .075)
            pos_hint: {'x': .35, 'y': .7}
        ButtonLabel:
            id: one
            text: 'One'
            pos_hint: {'x': .15, 'y': .425}
            size_hint: .11, .1
        ButtonLabel:
            id: two
            text: 'Two'
            pos_hint: {'x': .4, 'y': .425}
            size_hint: .13, .1
        ButtonLabel:
            id: three
            text: 'Three'
            pos_hint: {'x': .65, 'y': .425}
            size_hint: .165, .1

<DieHolder>:

<KeeperBox>:

<DieBasket>:
    keeper_box: keeper_box
    size_hint: 1, 0.4
    pos_hint: {'x': 0.0, 'y': 0.6}
    canvas.after:
        Color:
            rgba: root.valid_basket
        Rectangle:
            pos: self.x, self.y
            size: self.width, self.x + 3
    Label:
        text: 'Put Dice Up Here To Score'
        font_size: 18
        bold: True
        color: rgba(colors['text'])
        halign: 'center'
        pos_hint: {'x': self.x, 'y': -0.425}
    KeeperBox:
        id: keeper_box
        pos_hint: {'x': 0, 'y': 0.33}
        size_hint: 1, 0.4
        padding: [5]
        spacing: 5
        DieHolder:
        DieHolder:
        DieHolder:
        DieHolder:
        DieHolder:
        DieHolder:

<Roll>:
    text: 'Roll \'em!'
    color: rgba(colors['text'])
    font_size: 35
    canvas.before:
        Color:
            rgba: rgba(colors['prime'])
        Rectangle:
            pos: self.pos
            size: self.size

<EndTurn>:
    text: 'End Turn'
    color: rgba(colors['text'])
    font_size: 35
    canvas.before:
        Color:
            rgba: rgba(colors['prime'])
        Rectangle:
            pos: self.pos
            size: self.size

<KeepAll>:
    text: 'Keep All'
    color: rgba(colors['text'])
    font_size: 35
    canvas.before:
        Color:
            rgba: rgba(colors['prime'])
        Rectangle:
            pos: self.pos
            size: self.size

<Rules>:
    text: 'See Rules'
    color: rgba(colors['text'])
    font_size: 35
    canvas.before:
        Color:
            rgba: rgba(colors['prime'])
        Rectangle:
            pos: self.pos
            size: self.size

<GameButtonRow>:
    size_hint: 1, .15
    pos_hint: {'x': 0, 'y': 0}
    padding: [5]
    spacing: 5

<Base>:
    Image:
        source: 'images/tabletop2.jpg'
        allow_stretch: True
        keep_ratio: False

<PlayerScore>:

<ScoreArea>:
    size_hint: 1, 0.1
    pos_hint: {'x': 0, 'y': 0.9}
    canvas:
        Color:
            rgba: rgba(colors['prime dark'])
        Rectangle:
            pos: self.pos
            size: self.size

<GameScreen>:
    name: 'game'
    base: base
    Base:
        score_area: score_area
        die_basket: die_basket
        dice: dice
        buttons: buttons
        id: base
        ScoreArea:
            id: score_area
        DieBasket:
            id: die_basket
            active_game: root.active_game
        Dice:
            id: dice
        GameButtonRow:
            id: buttons
            roll: roll
            end_turn: end_turn
            keep: keep
            rules: rules
            Roll:
                id: roll
            EndTurn:
                id: end_turn
            KeepAll:
                id: keep
            Rules:
                id: rules
